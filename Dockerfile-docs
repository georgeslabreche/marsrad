# Dockerfile for generating mars package PDF documentation
#
# Lightweight container with R and minimal TeX for building the package reference manual.
#
# Usage (from repository root):
#   # On Apple Silicon Macs:
#   docker build --platform linux/amd64 -t mars-docs -f Dockerfile-docs .
#   docker run --rm --platform linux/amd64 -v $(pwd)/docs:/output mars-docs
#
#   # On Intel Macs/Linux:
#   docker build -t mars-docs -f Dockerfile-docs .
#   docker run --rm -v $(pwd)/docs:/output mars-docs
#
# The generated PDF will be written to docs/mars-manual.pdf

FROM --platform=linux/amd64 r-base:latest

# Install minimal TeX packages needed for R CMD Rd2pdf
RUN apt-get update && apt-get install -y \
    texlive-latex-base \
    texlive-fonts-recommended \
    texlive-latex-extra \
    texlive-fonts-extra \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /pkg

# Copy package files
COPY . /pkg/

# Generate the PDF documentation from man/ directory only
CMD R CMD Rd2pdf --no-preview --title="Mars Package Reference Manual" /pkg/man --output=/output/mars-manual.pdf && \
    echo "PDF generated successfully at /output/mars-manual.pdf"
